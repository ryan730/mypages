window._rich_apm||function(){var a=+new Date;this._config={v:"1.0",uid:"80d4c077ff6442c08887dcbafd3bab03",url:"http://interface.richapm.com/datareceiving/bQGDdvjfYci?_tp=timing",err_url:"http://interface.richapm.com/datareceiving/bQGDdvjfYci?_tp=error",ajax_url:"http://interface.richapm.com/datareceiving/bQGDdvjfYci?_tp=xhrq",slow_url:"http://interface.richapm.com/datareceiving/bYcOdLjfYce?_tp=resource",trace_threshold:5000,delay:0,reprottype:"img",inittbs:2e3,reservestbs:20},this.getNow=function(){return+new Date},this.duc=function(a){return window.decodeURIComponent?decodeURIComponent(a):a},this.euc=function(a){return window.encodeURIComponent?encodeURIComponent(a):a},this.toimgreport=function(a){var b=new Image;b.src=a},this.toajaxreport=function(a){var b=new xhrhandler;b.request("GET",a)},this.getpointtime=function(){return this.pf&&this.pf.now&&this.pf.now()||this.getNow()},this.arrreport=[],this.toreport=function(a,b){var a=a+(-1==a.indexOf("?")&&b?"?":"")+(b?"&"+b:"");null!=tcparm?(a+=1==tcparm?"":"&tc="+tcparm,"img"==_config.reprottype?toimgreport(a):"ajax"==_config.reprottype&&toajaxreport(a)):pagetcparm(function(b){a+=1==b?"":"&tc="+b,"img"==_config.reprottype?toimgreport(a):"ajax"==_config.reprottype&&toajaxreport(a)})},this.qualifyURL=function(a){var b=document.createElement("a");return b.href=a,b.cloneNode(!1).href},this.formatnum=function(a){var a=1*a,b=arguments,c=b[2]?b[2]:2;return isNaN(a)?0:1*a.toFixed(c)},this.addListener=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},this.json2paramUrl=function(a){var b,c;if(Object.keys)return Object.keys(a).map(function(b){return[euc(b),euc(a[b])].join("=")}).join("&");b="";for(c in a)b+="&"+euc(c)+"="+euc(a[c]);return b.substr(1)},this.addurlparmdata=function(a,b){var c={};return b?c.res=a:c=a,c.ref=window.location.href,c._=getNow(),c.v=_config.v,c.uid=_config.uid,c},this.createreporturl=function(a){if(!a)return a;var a=a+(-1==a.indexOf("?")?"?":"&"),b=addurlparmdata({},0);return a+json2paramUrl(b)},this.pagetcparm=function(a){var b,e;if(!tcparm){try{b=new XMLHttpRequest}catch(c){try{b=ActiveXobject("Msxml12.XMLHTTP")}catch(c){try{b=ActiveXobject("Microsoft.XMLHTTP")}catch(d){b=!1}}}b?(b.open("GET",window.location.href,!1),b.setRequestHeader("_TOREPORT",!0),b.send(null),e=b.getResponseHeader("sRichInfoAPMHeader")||1,"function"==typeof a&&a(e),tcparm=e):tcparm=1}},this.tcparm=null,this.pf=window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance||!1,this.timing={getTimes:function(a){var b,c,d,e,f;if(!pf||!Object.keys)return!1;if(b=pf.timing,c={},a=a||{},b){if(a&&!a.simple)for(d in b)b.hasOwnProperty&&b.hasOwnProperty(d)&&(c[d]=b[d]);void 0===c.firstPaint&&(e=0,window.chrome&&window.chrome.loadTimes?(e=1e3*window.chrome.loadTimes().firstPaintTime,c.firstPaintTime=e-1e3*window.chrome.loadTimes().startLoadTime):"number"==typeof pf.timing.msFirstPaint&&(e=pf.timing.msFirstPaint,c.firstPaintTime=e-pf.timing.navigationStart),a&&!a.simple&&(c.firstPaint=e)),f=b.navigationStart,c.loadTime=b.loadEventEnd-f,c.domReady=b.domComplete-b.responseEnd,c.domReadyTime=b.domComplete-b.domInteractive,c.readyStart=b.fetchStart-f,c.redirectTime=b.redirectEnd-b.redirectStart,c.appcacheTime=b.domainLookupStart-b.fetchStart,c.unloadEventTime=b.unloadEventEnd-b.unloadEventStart,c.lookupDomainTime=b.domainLookupEnd-b.domainLookupStart,c.sslconnectTime=b.secureConnectionStart&&b.secureConnectionStart-b.navigationStart||0,c.connectTime=b.connectEnd-b.connectStart,c.netTime=b.connectEnd-b.domainLookupStart,c.requestTime1=b.responseStart-b.requestStart,c.responeTime=b.responseEnd-b.responseStart,c.requestTime=b.responseEnd-b.requestStart,c.initDomTreeTime=b.domInteractive-b.responseEnd,c.loadEventTime=b.loadEventEnd-b.loadEventStart,c.ttfb=b.responseStart-f,c.clientTime=b.domainLookupStart-f,c.unloads=0==b.unloadEventStart?0:b.unloadEventStart-f,c.unloade=0==b.unloadEventEnd?0:b.unloadEventEnd-f,c.redirects=0==b.redirectStart?0:b.redirectStart-f,c.redirecte=0==b.redirectEnd?0:b.redirectEnd-f,c.caches=b.fetchStart-f,c.dnss=b.domainLookupStart-f,c.dnse=b.domainLookupEnd-f,c.tcps=b.connectStart-f,c.tcpe=b.connectEnd-f,c.requests=b.requestStart-f,c.responses=b.responseStart-f,c.responsee=b.responseEnd-f,c.doms=b.domLoading-f,c.dome=b.domContentLoadedEventEnd-f,c.pagee=b.loadEventEnd-f}return c},getNavigation:function(){if(pf){var a=pf.navigation;return{type:a.type,count:a.redirectCount}}},getEntries:function(){if(pf&&Object.keys){var a=pf&&pf.getEntriesByType&&pf.getEntriesByType("resource")||{},b=[],c=["connectEnd","connectStart","domainLookupEnd","domainLookupStart","duration","entryType","fetchStart","initiatorType","name","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","startTime","workerStart"];return Object.keys(a).forEach(function(d){var f,g,h,e={};for(f in c)g=c[f],h=a[d][g],e[g]=isNaN(h)?void 0==h?0:h:formatnum(h);b.push(e)}),b}},printTable:function(a){var b={},c=this.getTimes(a)||{};return Object.keys(c).sort().forEach(function(a){b[a]={ms:c[a],s:+formatnum(c[a]/1e3)}})},printSimpleTable:function(){this.printTable({simple:!0})},output:function(a){var b={},c={},d=this.getTimes()||{},e=this.getNavigation(),f={dt:"loadTime",rt:"domReadyTime",nt:"netTime",ft:"firstPaintTime",wt:"ttfb",tt:"connectTime",st:"initDomTreeTime"},g={dt:"loadTime",ct:"clientTime",lt:"lookupDomainTime",tt:"connectTime",qt:"requestTime1",pt:"responeTime",rt:"domReadyTime",ot:"loadEventTime",nt:"netTime",st:"initDomTreeTime",wt:"ttfb",us:"unloads",ue:"unloade",rs:"redirects",re:"redirecte",cs:"caches",ce:"dnss",ds:"dnss",de:"dnse",ts:"tcps",te:"tcpe",es:"requests",ee:"responses",os:"responses",oe:"responsee",ms:"doms",me:"dome",ps:"dome",pe:"pagee"};if(d)return Object.keys&&Object.keys(f).sort().forEach(function(a){b[a]=d[f[a]]<0?0:formatnum(d[f[a]])}),Object.keys&&Object.keys(g).sort().forEach(function(a){c[a]=d[g[a]]<0?0:formatnum(d[g[a]])}),void 0==b.dt&&(b.fl=1,b.dt=0,b.rt=0,b.nt=0,b.ft=0,b.wt=0,b.tt=0,b.st=0),b.tn=e&&e.type||0,b.cn=e&&e.count||0,b.profile=c,"function"==typeof a?a(b):b},outputEntries:function(a,b){return a?"function"==typeof b?b(a):a:void 0}},this.xhrhandler=function(){},xhrhandler.prototype={request:function(a,b,c,d){var f,g,h,i,e=/msie\s+([\d.]+);/gi.exec(navigator.appVersion);return e&&9==parseInt(e[1])&&(f=window.location,g=f.protocol+"://"+f.hostname+(f.port?":"+f.port:""),-1==b.indexOf(g))?(h=window.XDomainRequest(),h.open(a,b),"POST"!==a&&(d=null),h.send(d),void 0):(i=this.createXhrObject(),c=c||{},d=d||null,i.onreadystatechange=function(){4===i.readyState&&(200===i.status?c.success&&c.success(i.responseText,i.responseXML):c.failure&&c.failure(i.status))},i.open(a,b,!0),"POST"!==a&&(d=null),i._TOREPORT=!0,i.send(d),void 0)},createXhrObject:function(){var b,c,a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(b=0,c=a.length;c>b;b++){try{a[b]()}catch(d){continue}return this.createXhrObject=a[b](),a[b]()}throw new Error("xhrhandler: Could not create an XHR object.")}},this.err_report=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;return a.err_report?a.err_report:(b=[],c={id:0,uin:0,url:"",combo:1,ext:{},level:4,ignore:[],random:1,delay:1e3,submit:null},d=function(a,b){return Object.prototype.toString.call(a)==="[object "+(b||"Object")+"]"},e=function(a){var b=typeof a;return"object"===b&&!!a},f=function(a){return null===a?!0:d(a,"Number")?!1:!a},g=a.onerror,a.onerror=function(b,c,e,f,h){var j=b;h&&h.stack&&(j=i(h)),d(j,"Event")&&(j+=j.type?"--"+j.type+"--"+(j.target?j.target.tagName+"::"+j.target.src:""):""),o.push({name:b,msg:j,target:c,rowNum:e,colNum:f}),n(),g&&g.apply(a,arguments)},h=function(a){var b,c,d;try{return a.stack?(b=a.stack.match("https?://[^\n]+"),b=b?b[0]:"",c=b.match(":(\\d+):(\\d+)"),c||(c=[0,0,0]),d=i(a),{msg:d,rowNum:c[1],colNum:c[2],target:b.replace(c[0],"")}):a.name&&a.message&&a.description?{msg:JSON.stringify(a)}:a}catch(e){return a}},i=function(a){var b=a.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,5).join("@").replace(/\?[^:]+/gi,""),c=a.toString();return b.indexOf(c)<0&&(b=c+"@"+b),b},j=function(a,b){var i,j,d=[],g=[],h=[];if(e(a)){a.level=a.level||c.level;for(i in a)if(j=a[i],!f(j)){if(e(j))try{j=JSON.stringify(j)}catch(k){j="[err_report detect value stringify error] "+k.toString()}h.push(i+":"+j),d.push(i+"="+euc(j)),g.push(i+"["+b+"]="+euc(j))}}return[g.join("&"),h.join(","),d.join("&")]},k=function(a){c.submit?c.submit(a):toreport(a)},l=[],m=0,n=function(a){var e,f,g,h,i,n,o;if(c.report){for(;b.length;){if(e=!1,f=b.shift(),g=j(f,l.length),d(c.ignore,"Array"))for(h=0,i=c.ignore.length;i>h;h++)if(n=c.ignore[h],d(n,"RegExp")&&n.test(g[1])||d(n,"Function")&&n(f,g[1])){e=!0;break}e||(c.combo?l.push(g[0]):k(c.report+g[2]),c.onReport&&c.onReport(c.id,f))}l.length&&(o=function(){clearTimeout(m),k(c.report+l.join("&")+"&count="+l.length),m=0,l=[]},a?o():m||(m=setTimeout(o,c.delay)))}},o={push:function(a){return Math.random()>=c.random?o:(b.push(e(a)?h(a):{msg:a}),n(),o)},report:function(a){return a&&o.push(a),n(!0),o},info:function(a){return a?(e(a)?a.level=2:a={msg:a,level:2},o.push(a),o):o},debug:function(a){return a?(e(a)?a.level=1:a={msg:a,level:1},o.push(a),o):o},init:function(a){var b,d;if(e(a))for(b in a)c[b]=a[b];return d=c.id,d&&(c.report=createreporturl(c.url)+(c.ext.length?"&ext="+JSON.stringify(c.ext):"")+"&"),o},__onerror__:a.onerror},"undefined"!=typeof console&&console.error&&setTimeout(function(){var a=((location.hash||"").match(/([#&])BJ_ERROR=([^&$]+)/)||[])[2];a&&console.error("BJ_ERROR",duc(a).replace(/(:\d+:\d+)\s*/g,"$1\n"))},0),o)}(window),this.getAjaxTimeing=function(){function c(){}function f(a){var b,c;return d.onRedirectResponse&&(b=a.getResponseHeader("Location"),302==a.getResponseHeader("status")&&b)?(d.onRedirectResponse(b,a),void 0):(c=d.onResponse(a),c===!1&&d.abort(a),void 0)}function g(b){var d,c=b.listenerParams[b._uniqueID];c.isAbort||(d=b.onreadystatechange,null==d&&null==b.onload?setTimeout(function(){g(b)}):(b.readyState&&(c.t1=getpointtime()),b.onreadystatechange=function(){var e,h,g,i;switch(b.readyState){case 0:break;case 1:break;case 2:c.t2=getpointtime();break;case 3:break;default:if(200==b.status&&f(b),!pf)return;c.t4=getpointtime(),e={},e.s=b.status,e.t=c.method,e.l=b.responseText.length,e.u=c.data&&c.data.length||0,xhrurl=b.responseURL||c.url,g=pf.getEntriesByName&&pf.getEntriesByName(xhrurl)||{},0==g.length?(g=pf.getEntriesByType&&pf.getEntriesByType("resource")||{},Object.keys(g).reverse().forEach(function(a){var b=g[a];return 0===b.name.indexOf(xhrurl)?(h=b,void 0):void 0}),_config.reservestbs<=g.length&&clearperformanceResource()):(h=g.hasOwnProperty("pop")?g.pop():"",_config.reservestbs<=g.length+1&&clearperformanceResource()),h&&(xhrurl=h.name,e.lt=formatnum(h.fetchStart-h.startTime),e.dt=formatnum(h.duration),e.tt=formatnum(h.connectEnd-h.connectStart),e.rt=formatnum(h.responseEnd-(h.requestStart||h.fetchStart))),e.url=xhrurl,i=c.st,a(e,i,c.t1-c.st,c.t4-c.t1)}c.isAbort||d&&d()}))}var b,d,e,a=function(a,b){if(void 0==a.dt){var c=arguments;a.lt=0,a.dt=getpointtime()-b>0?getpointtime()-b:0,a.tt=c[2]||0,a.rt=c[3]||0}toreport(_config.ajax_url,json2paramUrl(addurlparmdata(a)))};return window&&!window.XMLHttpRequest&&window.ActiveXObject&&(window.XMLHttpRequest=function(){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}),window&&!window.XMLHttpRequest?(console&&console.error("This browser does not support XMLHttpRequest."),void 0):(b=window.XMLHttpRequest,c.prototype.beforeSend=function(){},c.prototype.extend=function(a){for(var b in a)"extend"!=b&&"xhrOpen"!=b&&"xhrSend"!=b&&"abort"!=b&&(this[b]=a[b]||this[b])},c.prototype.xhrOpen=b.prototype.open,c.prototype.xhrSend=b.prototype.send,c.prototype.onResponse=function(){},c.prototype.abort=function(a){a.listenerParams[a._uniqueID].isAbort=!0;try{a.abort()}catch(b){console&&console.error(b)}},d=new c,b.prototype.uniqueID=function(){return this._uniqueID||(this._uniqueID=Math.floor(1e3*Math.random())),this._uniqueID},b.prototype.listenerParams=[],e=b.prototype.setRequestHeader,b.prototype.setRequestHeader=function(a,b){this.listenerParams[this._uniqueID].headers[a]=b,e.apply(this,arguments)},b.prototype.open=function(a,b,c){var e=this.uniqueID(),f=this.listenerParams,a=a&&a.toLowerCase()||"";f[e]={},f[e].headers=[],f[e].method=a,f[e].url=qualifyURL(b),f[e].async=c,f[e].data="get"==a?b.split("?")[1]:null,f[e].isAbort=!1,f[e].st=getpointtime(),d.xhrOpen.apply(this,arguments)},b.prototype.send=function(a){var b,c,e;if(this._TOREPORT)return delete this.listenerParams[this._uniqueID],d.xhrSend.call(this,a),void 0;if(b=this,c=b.listenerParams[this._uniqueID],"post"==c.method&&(c.data=a),e=d.beforeSend(b),e===!1)d.abort(b);else{g(b);try{d.xhrSend.apply(this,arguments)}catch(f){}}},d)},this.init=function(){pf&&setTimeout(function(){var b=window._rich_parms&&window._rich_parms.at||0;timing.output(function(c){var f,d=c.profile,e=c.fl;void 0!=d&&delete c.profile,e&&(delete c.fl,c.dt=getNow()-a),c.at=b,toreport(_config.url,json2paramUrl(addurlparmdata(c))),_config.trace_threshold<c.dt&&(f=timing.getEntries(),f&&timing.outputEntries(f,function(a){var e,c=addurlparmdata(a,1);return c.res.length?(c.pf=d||{},c.pf.at=b,c.ref=window.location.href,e=new xhrhandler,null!=tcparm?(1!=tcparm&&(c.tc=tcparm),e.request("POST",createreporturl(_config.slow_url),{},JSON.stringify(c))):pagetcparm(function(a){c.tc=a,e.request("POST",createreporturl(_config.slow_url),{},JSON.stringify(c))}),void 0):!1})),clearperformanceResource()})},50)},this.clearperformanceResource=function(){try{setTimeout(function(){pf&&(pf.clearResourceTimings&&pf.clearResourceTimings(),setTimeout(function(){pf.setResourceTimingBufferSize&&pf.setResourceTimingBufferSize(_config.reservestbs)},0))},0)}catch(a){}},pf&&pf.setResourceTimingBufferSize&&pf.setResourceTimingBufferSize(_config.inittbs),addListener(window,"load",init),addListener(window,"resourcetimingbufferfull",clearperformanceResource),getAjaxTimeing(),this.err_report.init({id:_config.uid,url:_config.err_url,v:_config.v,delay:_config.delay})}();
